(function(){var e,t,n,i,r,a;i={register:{saveSettingsSuccess:function(e){return a.nativeBridge.saveSettingsSuccess=e},saveSettingsFail:function(e){return a.nativeBridge.saveSettingsFail=e},settingsChanged:function(e){return a.nativeBridge.settingsChanged=e},privacyChanged:function(e){return a.nativeBridge.privacyChanged=e},savePrivacySuccess:function(e){return a.nativeBridge.savePrivacySuccess=e},savePrivacyFail:function(e){return a.nativeBridge.savePrivacyFail=e},forwardOnePanel:function(e){return a.nativeBridge.forwardOnePanel=e},receivingFile:function(e){return a.nativeBridge.receivingFile=e},saveSettings:function(e){return a.nativeBridge.saveSettings=e},savePrivacy:function(e){return a.nativeBridge.savePrivacy=e}},deregister:{saveSettings:function(){return a.nativeBridge.saveSettings=null}},trigger:{backOnePanel:function(){return $(document).trigger("backOnePanel")},forwardOnePanel:function(e){var t;return"function"==typeof(t=a.nativeBridge).forwardOnePanel?t.forwardOnePanel(e):void 0},settingsChanged:function(e){var t;return"function"==typeof(t=a.nativeBridge).settingsChanged?t.settingsChanged(e):void 0},saveSettings:function(){return null!=a.nativeBridge.saveSettings?a.nativeBridge.saveSettings():$(document).trigger("saveSettings")},saveSettingsSuccess:function(){var e,t;return(null!=(t=a.device)?t.can("signalStatusWithLocation"):void 0)?window.location.href="/rn-app/op/success":"function"==typeof(e=a.nativeBridge).saveSettingsSuccess?e.saveSettingsSuccess():void 0},saveSettingsFail:function(e){var t,n;return(null!=(n=a.device)?n.can("signalStatusWithLocation"):void 0)?window.location.href="/rn-app/op/fail?error="+encodeURIComponent(e):"function"==typeof(t=a.nativeBridge).saveSettingsFail?t.saveSettingsFail(e):void 0},savePrivacy:function(){return null!=a.nativeBridge.savePrivacy?a.nativeBridge.savePrivacy():$(document).trigger("savePrivacy")},savePrivacySuccess:function(){var e,t;return(null!=(t=a.device)?t.can("signalStatusWithLocation"):void 0)?window.location.href="/rn-app/op/success":"function"==typeof(e=a.nativeBridge).savePrivacySuccess?e.savePrivacySuccess():void 0},savePrivacyFail:function(e){var t,n;return(null!=(n=a.device)?n.can("signalStatusWithLocation"):void 0)?window.location.href="/rn-app/op/fail?error="+encodeURIComponent(e):"function"==typeof(t=a.nativeBridge).savePrivacyFail?t.savePrivacyFail(e):void 0},receivingFile:function(e){var t;return"function"==typeof(t=a.nativeBridge).receivingFile?t.receivingFile(e):void 0}}},n={trigger:{convertLayoutSuccess:function(){if(canTriggerLocChange())return window.location.href="/op/panel/close"},convertLayoutFail:function(){if(canTriggerLocChange())return window.location.href="/op/panel/error?error_msg="+encodeURIComponent(error)}}},t={callbacks:{},registerCallback:function(e,t){var n;return null!=(n=a.nativeBridge.callbacks)?n[e]=t:void 0},deregisterCallback:function(e){var t;return null!=(t=a.nativeBridge.callbacks)?t[e]=null:void 0},register:{filePickDone:function(e){return a.nativeBridge.filePickDoneEvent=e},remake:function(e){return a.nativeBridge.remakeEvent=e}},deregister:{filePickDone:function(){return a.nativeBridge.filePickDoneEvent=null},remake:function(){return a.nativeBridge.remakeEvent=null}},dispatch:function(e){return a.xstore.dispatch(e)},trigger:{createPost:function(){return $(document).trigger("post:create")},filePickDone:function(e){return a.nativeBridge.filePickDoneEvent?a.nativeBridge.filePickDoneEvent(e):$(document).trigger("pick:done",e)},remake:function(){return a.nativeBridge.remakeEvent?a.nativeBridge.remakeEvent():$(document).trigger("remake")},showConfirm:function(e){var t;return null!=(t=a.nativeBridge)?t.callbacks.showConfirm(e):void 0},createPostWithMedia:function(e){var t;if(null==e&&(e={}),null!=e.url)return a.xstore.state,t={attachment:e.url},a.xstore.dispatch({type:"post/createPost",post:t})}}},(e=null!=(r=(a=window.ww||(window.ww={})).nativeBridge)?r.addMessageHandler.bind(a.nativeBridge):void 0)("padlet_settings_update",function(e){var t;return null!=(t=a.xstore)?t.dispatch({type:"settings/updateAndValidatePreviewAttributes"},$.extend(!0,{},e.preview_attributes)):void 0}),e("padlet_settings_hide",function(){var e;return null!=(e=a.xstore)?e.dispatch({type:"settings/hideSettingsPanel"}):void 0}),e("create_post",function(e){var t;return t=e,a.xstore.dispatch({type:"post/createPost",attributes:t})}),e("cancel_show",function(){var e;return null!=(e=a.xstore.state).postAction.postUnderActionCid&&a.xstore.dispatch({type:"postAction/hidePostActionMenu"}),null!=e.section.actionMenuSectionId&&a.xstore.dispatch({type:"section/hideSectionActionMenu"}),null!=e.comment.actionMenuCommentId&&a.xstore.dispatch({type:"comment/hideCommentActionMenu"}),a.xstore.dispatch({type:"settings/hideSettingsPanel"}),a.xstore.dispatch({type:"share/resetSharePanel"}),a.xstore.dispatch({type:"hideRemakePanel"}),a.xstore.dispatch({type:"hideConvertLayoutPanel"}),a.xstore.dispatch({type:"postAction/endPostCopy"}),a.xstore.dispatch({type:"postAction/endPostTransfer"})}),a.nativeBridge=$.extend(!0,a.nativeBridge||{},t,i,n)}).call(this),function(){window.ww||(window.ww={}),ww.sorter={getAbsoluteSortIndex:function(e,t){return null==e&&(e=new Date),null==t&&(t=ww.store.getState()),t=ww.store.getState(),1024*(e-new Date(t.wall.get("created_at")))},getSortIndex:function(e,t){var n;return null==e&&(e=new Date),null==t&&(t=ww.store.getState()),n=this.getAbsoluteSortIndex(e),"bottom"===t.wall.attributes.new_wish_loc?-n:n},getTopSortIndex:function(){return this.getAbsoluteSortIndex()},getBottomSortIndex:function(){return-this.getAbsoluteSortIndex()},sortPosts:function(e){return"chat"===ww.store.getState().wallLayout?_.sortBy(e,function(e){return e.id?e.attributes.created_at:new Date}):_.sortBy(e,function(e){return e.sortIndex()}).reverse()},saveNewIndex:function(e,t){var n,i,r,a,o,s,c,u;return null==t&&(t={}),n=$(e),c=t.sectionId,r=void 0===t.prevId?n.prev(".wish"):null!=t.prevId?$("#"+t.prevId):$([]),i=void 0===t.nextId?n.next(".wish"):null!=t.nextId?$("#"+t.nextId):$([]),o=n.data("post-id"),0!==i.length||0!==r.length?(0===i.length?a=this.getBottomSortIndex():0===r.length&&(s=this.getTopSortIndex()),null==a&&(a=parseInt(i.attr("data-rank"))),null==s&&(s=parseInt(r.attr("data-rank"))),u=parseInt((s+a)/2),ww.store.dispatch({type:"SORTED_POST",postId:o,sortIndex:u,sectionId:c})):null!=c?(u=this.getSortIndex(),ww.store.dispatch({type:"SORTED_POST",postId:o,sectionId:c,sortIndex:u})):void 0}}}.call(this),function(){window.ww||(window.ww={}),ww.sectionSorter={getSortIndex:function(e){return null==e&&(e=new Date),new Date(e.toISOString()).getTime()/1e3},getTopSortIndex:function(){return-this.getSortIndex()},getBottomSortIndex:function(){return this.getSortIndex()},sortSections:function(e){return _.sortBy(e,function(e){return e.get("sort_index")})},saveNewIndex:function(e,t){var n,i,r,a,o,s,c;if(null==t&&(t={}),r=(n=$(e)).prev("padlet-section"),0!==(i=n.next("padlet-section")).length||0!==r.length)return 0===i.length?a=this.getBottomSortIndex():0===r.length&&(o=this.getTopSortIndex()),null==a&&(a=parseInt(i.attr("data-rank"))),null==o&&(o=parseInt(r.attr("data-rank"))),c=parseInt((o+a)/2),s=n.data("section-id"),ww.store.dispatch({type:"SORTED_SECTION",sectionId:s,sortIndex:c})}}}.call(this),function(){}.call(this);