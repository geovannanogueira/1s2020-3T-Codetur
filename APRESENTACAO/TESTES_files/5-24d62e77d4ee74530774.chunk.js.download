(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{338:function(t,e,n){},339:function(t,e,n){},340:function(t,e,n){},484:function(t,e,n){"use strict";var o=n(2),i=n(10),r=n(9),c=n(91),a=n(14),s=n(32),u=n(49),l=n.n(u),h=n(209),d=n.n(h),b=n(4),f=n(7);function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var m={components:{MultilineInput:c.a},directives:{t:a.a},props:["body","subject","bodyPlaceholder","showSubjectField"],data:function(){return{value:"",invalidUrlMessage:Object(b.a)("Please enter a valid URL."),toolbarInputFocused:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){v(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(o.e)(["isMobile","isApp"]),{inputId:function(){return l()("words")},toolbarId:function(){return l()("trixtoolbar")},floatingToolbar:function(){return!this.isMobile},fixedToolbar:function(){return this.isMobile&&!this.isApp}}),watch:{body:function(t){t?this.changeContent(t):this.changeContent("")},subject:function(t){t?this.changeSubject(t):this.changeSubject("")},toolbarInputFocused:function(t){t&&this.checkAndToggleFixedToolbar()}},beforeDestroy:function(){this.$toolbar&&this.$toolbar.remove()},beforeMount:function(){var t=this.floatingToolbar?"toolbar-floating":"toolbar-fixed",e=document.body;this.$toolbar=Object(f.a)('<trix-toolbar class="'.concat(t,'" id="').concat(this.toolbarId,'"></trix-toolbar>')).appendTo(e)},mounted:function(){var t=this;this.$editor=Object(f.a)(this.$refs.trix);var e=this.$editor,n=this.$toolbar,o=n.find("input");n.on("click",(function(t){t.stopPropagation()})),d()((function(){Object(f.a)('<button class="trix-back-button icon-button immaterial-icons" title="Back to formatting menu">arrow_back</button>').prependTo(n.find(".trix-dialog__link-fields")).on("click",(function(){var t=n.find("[data-trix-action=link]")[0],e=new CustomEvent("mousedown",{bubbles:!0,cancelable:!0});t.dispatchEvent(e)}))})),o.on("focus",(function(){var n,o,i,r,c;t.toolbarInputFocused=!0,t.value||(o=(i=e.get(0)).editor.getDocument().toString(),n=i.editor.getSelectedRange(),r=o.substring(n[0],n[1]),Object(s.b)(r)?t.value=r:(c="http://"+r,Object(s.b)(c)&&(t.value=c)))})),o.on("invalid",(function(){var e,o;t.toolbarInputFocused=!1,0===(o=t.value).indexOf("http://")||0===o.indexOf("https://")?alert(t.invalidUrlMessage):(e="http://"+o,Object(s.b)(e)?(t.value=e,n.find("input[data-method=setAttribute]").click()):alert(t.invalidUrlMessage))}))},methods:{focus:function(){var t=this;this.$refs.trix.focus(),this.$nextTick((function(){t.checkAndToggleFixedToolbar()}))},changeContent:function(t){this.$refs.trix&&this.$refs.trix.editor&&this.$refs.trix.editor.loadHTML(t)},changeSubject:function(t){this.$refs.subject&&(this.$refs.subject.value=t)},getSubject:function(){return this.$refs.subject.value},getContent:function(){return this.$refs.content.value},repositionToolbar:function(){var t=this.$refs.trix.editor,e=this.$toolbar,n=t.getSelectedRange();if(n[0]!==n[1]){var o=t.getClientRectAtPosition(n[0]),i=t.getClientRectAtPosition(n[1])||o,r=o.top,c=Math.min(o.left,i.left),a=i.top,s=Math.max(o.left,i.left),u=Object(f.a)(this.$parent.$el),l={preventDefault:!0,pageX:r!==a?u.offset().left+u.width()/2:(c+s)/2,pageY:Math.max(r-10,0)};this.isAndroid?e.show().position({my:"center bottom",at:"center bottom",of:Object(f.a)(document),collision:"fit flip"}):e.show().position({my:"center bottom",at:"center top",of:l,collision:"fit flip"})}else e.hide()},onEditorFocus:function(){this.checkAndToggleFixedToolbar()},onEditorBlur:function(){this.fixedToolbar&&!this.toolbarInputFocused&&this.$toolbar.hide()},onEditorSelectionChange:function(){this.floatingToolbar&&this.repositionToolbar()},checkAndToggleFixedToolbar:function(){this.fixedToolbar&&this.$toolbar.show()},onSubjectChange:function(t){var e=this.$refs.subject.value;this.$emit("subject-change",e)},onSubjectFocus:function(){this.fixedToolbar&&this.$toolbar.hide()},onSubjectEnterKeydown:function(t){var e=this;13===t.keyCode&&(t.preventDefault(),this.$nextTick((function(){e.$refs.trix.focus()})))},onEditorFileDrag:function(t){t.preventDefault()},onEditorChange:function(t){var e=this.$refs.content.value;this.$emit("change",e)},onAttachmentAdd:function(t){t.attachment&&t.attachment.remove(),t.originalEvent&&t.originalEvent.attachment&&t.originalEvent.attachment.remove()},onEditorPaste:function(t){var e=null,n=t.clipboardData;"function"===typeof n&&(e=n.getData("Text")),d()((function(){var n,o,i,r,c;return e&&Object(s.b)(e)?(o=(i=(r=t.explicitOriginalTarget||t.originalTarget||t.currentTarget).editor).getDocument().toString(),n=r.editor.getSelectedRange(),c=o.substring(0,n[0]).lastIndexOf(e),i.recordUndoEntry("Auto Link Paste"),i.setSelectedRange([c,n[0]]),i.activateAttribute("href",e),i.setSelectedRange(n)):""}))},onKeydown:function(t){this.isMobile||(this.$emit("enter"),t.preventDefault())}}},g=(n(509),n(1)),O=Object(g.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"composer-text-editor"},[t.showSubjectField?n("textarea",{directives:[{name:"t",rawName:"v-t:placeholder",value:"Title",expression:"'Title'",arg:"placeholder"}],ref:"subject",staticClass:"subject",attrs:{dir:"auto"},domProps:{value:t.subject},on:{input:t.onSubjectChange,focus:t.onSubjectFocus,keydown:t.onSubjectEnterKeydown}}):t._e(),t._v(" "),n("div",{staticClass:"body"},[n("input",{ref:"content",staticClass:"content",attrs:{id:t.inputId,type:"hidden"},domProps:{value:t.body},on:{keydown:function(e){return e.preventDefault(),t.onKeydown(e)}}}),t._v(" "),n("trix-editor",{ref:"trix",attrs:{dir:"auto",toolbar:t.toolbarId,input:t.inputId,placeholder:t.bodyPlaceholder},on:{"trix-focus":t.onEditorFocus,"trix-blur":t.onEditorBlur,"trix-selection-change":t.onEditorSelectionChange,"trix-file-accept":t.onEditorFileDrag,"trix-change":t.onEditorChange,"trix-attachment-add":t.onAttachmentAdd,paste:t.onEditorPaste,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:t.onKeydown(e)}}})],1)])}),[],!1,null,null,null).exports,j=n(13),w=n(104);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function C(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){k(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function k(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var x={components:{BaseIcon:r.a},directives:{t:a.a},data:function(){return{width:320,Source:w.a}},computed:C({},Object(o.e)(["windowWidth","isMobile"]),{contentSourceCount:function(){return this.width?Math.floor(this.width/40):5}}),watch:{windowWidth:function(t){var e=this;this.width=null,this.$nextTick((function(){e.width=e.$refs.wrapper.offsetWidth}))}},mounted:function(){this.width=this.$refs.wrapper.offsetWidth},methods:C({},Object(o.b)("contentPicker",["showContentSourceMenu","pickContentSource"]),{getContent:function(t){Object(j.a)("Content Menu","Selected Source","Wish "+t),this.pickContentSource({source:t})},getContentIfSupported:function(t){this.isMobile||this.getContent(t)},chooseContentSource:function(t){var e;e={left:t.clientX,top:t.clientY},this.showContentSourceMenu({position:e})}})},S=(n(510),Object(g.a)(x,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"wrapper",staticClass:"surface-attachment-picker"},[n("div",{staticClass:"pick-content"},[t.contentSourceCount>1?n("button",{directives:[{name:"t",rawName:"v-t:title",value:"Upload",expression:"'Upload'",arg:"title"}],staticClass:"icon-button",on:{click:function(e){return t.getContentIfSupported(t.Source.FileBrowser)}}},[n("label",{attrs:{for:"content-hidden-file-input"}},[n("base-icon",{attrs:{name:"upload"}})],1)]):t._e(),t._v(" "),t.contentSourceCount>2?n("button",{directives:[{name:"t",rawName:"v-t:title",value:"Link",expression:"'Link'",arg:"title"}],staticClass:"icon-button",on:{click:function(e){return t.getContent(t.Source.LinkInput)}}},[n("base-icon",{attrs:{name:"link"}})],1):t._e(),t._v(" "),t.contentSourceCount>3?n("button",{directives:[{name:"t",rawName:"v-t:title",value:"Google",expression:"'Google'",arg:"title"}],staticClass:"icon-button",on:{click:function(e){return t.getContent(t.Source.WebBrowser)}}},[n("base-icon",{attrs:{name:"search_web"}})],1):t._e(),t._v(" "),t.contentSourceCount>4?n("button",{directives:[{name:"t",rawName:"v-t:title",value:"Snap",expression:"'Snap'",arg:"title"}],staticClass:"icon-button",on:{click:function(e){return t.getContentIfSupported(t.Source.PhotoBooth)}}},[n("label",{attrs:{for:"content-hidden-image-input"}},[n("base-icon",{attrs:{name:"camera"}})],1)]):t._e(),t._v(" "),t.contentSourceCount>1?n("button",{directives:[{name:"t",rawName:"v-t:title",value:"More",expression:"'More'",arg:"title"}],staticClass:"icon-button",on:{click:t.chooseContentSource}},[n("base-icon",{attrs:{name:"more_horiz"}})],1):t._e(),t._v(" "),t.contentSourceCount<=1?n("button",{directives:[{name:"t",rawName:"v-t:title",value:"Add attachment",expression:"'Add attachment'",arg:"title"}],staticClass:"icon-button",on:{click:t.chooseContentSource}},[n("base-icon",{attrs:{name:"attachment"}})],1):t._e()])])}),[],!1,null,"6f0910e2",null).exports),P=n(217),E=n(17);function $(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$(Object(n),!0).forEach((function(e){T(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function T(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var A={components:{BaseIcon:r.a,SurfaceComposerTextEditor:O,SurfaceAttachmentPicker:S,SurfaceAttachmentPreview:P.a},directives:{t:a.a},mixins:[i.a],data:function(){return{originalAttributes:null,attachmentWidth:128,attachmentHeight:72,editorHeight:0}},computed:_({},Object(o.e)(["wishListMounted"]),{},Object(o.c)("post",["chatAttachment","postBeingEdited"]),{},Object(o.c)(["isBackchannel"]),{bodyPlaceholder:function(){return this.isBackchannel?this.__("Say something ..."):this.__("Write something ...")},inputId:function(){return l()("words")},toolbarId:function(){return l()("trixtoolbar")},button:function(){return!this.postBeingEdited||Object(E.j)(this.postBeingEdited)?"send":"save"},attachment:function(){return this.postBeingEdited&&this.postBeingEdited.attachment||this.chatAttachment},body:function(){return this.postBeingEdited?this.postBeingEdited.body:null},subject:function(){return this.postBeingEdited?this.postBeingEdited.subject:null},showRemoveIcon:function(){return!!this.attachment}}),watch:{postBeingEdited:function(t){t?Object(E.j)(t)||(null===this.originalAttributes&&(this.originalAttributes=_({},t)),this.focusOnComposer()):this.clearContent()},wishListMounted:function(t){var e=this;t&&this.$nextTick((function(){return e.updateEditorHeight()}))}},beforeDestroy:function(){this._mutationObserver&&this._mutationObserver.disconnect()},mounted:function(){var t=this;this.postBeingEdited&&(this.originalAttributes=_({},this.postBeingEdited)),this.focusOnComposer();this._mutationObserver=new MutationObserver((function(){t.updateEditorHeight()})),this._mutationObserver.observe(this.$el,{subtree:!0,childList:!0}),this.$nextTick((function(){return t.updateEditorHeight()}))},methods:_({},Object(o.b)(["resizeEditor"]),{},Object(o.b)("post",["savePost","startNewPost","stopEditingPost","removePostAttachment"]),{clearContent:function(){!this.isBackchannel&&this.$refs.editor.changeSubject(""),this.$refs.editor.changeContent(""),this.removeAttachment()},removeAttachment:function(){this.removePostAttachment()},focusOnComposer:function(){this.$refs.editor.focus()},cancel:function(){var t=this;this.postBeingEdited&&!Object(E.j)(this.postBeingEdited)&&this.savePost({attributes:this.originalAttributes}),this.stopEditingPost(),this.clearContent(),this.$nextTick((function(){t.isBackchannel&&(t.focusOnComposer(),t.clearContent())}))},sendOrSave:function(){var t=this;this.focusOnComposer();var e=this.attachment,n=this.isBackchannel?"":this.$refs.editor.getSubject(),o=this.$refs.editor.getContent();if(""!==n||""!==o||e&&""!==e){var i=_({},this.postBeingEdited,{subject:n,body:o,attachment:e});"save"===this.button&&(this.originalAttributes=null),this.savePost({attributes:i}),this.clearContent(),this.$nextTick((function(){t.isBackchannel&&(t.clearContent(),t.focusOnComposer())})),Object(j.a)("Posts","add","Chat Post Button")}else this.clearContent(),this.$nextTick((function(){t.isBackchannel&&t.clearContent()}))},updateEditorHeight:function(){var t=this.$el.offsetHeight;t!==this.editorHeight&&(this.editorHeight=t,this.resizeEditor({height:t}))}})},B=(n(511),Object(g.a)(A,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"surface-composer"},[n("div",{staticClass:"surface-composer-text-editor"},[n("surface-composer-text-editor",{ref:"editor",attrs:{"show-subject-field":!t.isBackchannel,"body-placeholder":t.bodyPlaceholder,subject:t.subject,body:t.body},on:{enter:t.sendOrSave}})],1),t._v(" "),t.attachment?n("div",{staticClass:"composer-attachment-preview-wrapper"},[n("div",{staticClass:"composer-attachment-preview"},[t.attachment?n("surface-attachment-preview",{staticClass:"composer-attachment",attrs:{url:t.attachment,width:t.attachmentWidth,height:t.attachmentHeight,actionable:!1,autocolor:!1}}):t._e(),t._v(" "),t.showRemoveIcon?n("div",{directives:[{name:"t",rawName:"v-t:title",value:"Remove attachment",expression:"'Remove attachment'",arg:"title"}],key:"remove",staticClass:"attachment-controls remove-attachment",on:{click:t.removeAttachment}},[n("base-icon",{attrs:{name:"close"}})],1):t._e()],1)]):t._e(),t._v(" "),n("div",{staticClass:"composer-attachment-picker-wrapper"},[n("button",{directives:[{name:"t",rawName:"v-t"}],staticClass:"caption-text-button narrow-button",on:{click:t.cancel}},[t._v("Cancel")]),t._v(" "),t.attachment?t._e():n("surface-attachment-picker"),t._v(" "),"send"===t.button?n("button",{directives:[{name:"t",rawName:"v-t"}],key:"button-send",staticClass:"flat-button narrow-button",on:{click:t.sendOrSave}},[t._v("\n      Post\n    ")]):n("button",{directives:[{name:"t",rawName:"v-t"}],key:"button-save",staticClass:"flat-button narrow-button",on:{click:t.sendOrSave}},[t._v("Save")])],1)])}),[],!1,null,null,null));e.a=B.exports},509:function(t,e,n){"use strict";var o=n(338);n.n(o).a},510:function(t,e,n){"use strict";var o=n(339);n.n(o).a},511:function(t,e,n){"use strict";var o=n(340);n.n(o).a}}]);
//# sourceMappingURL=5-24d62e77d4ee74530774.chunk.js.map